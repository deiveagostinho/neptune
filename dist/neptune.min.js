(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.neptune=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(){var root=this;function VerbalExpression(){var verbalExpression=new RegExp;VerbalExpression.injectClassMethods(verbalExpression);return verbalExpression}VerbalExpression.injectClassMethods=function(verbalExpression){for(var method in VerbalExpression.prototype){if(VerbalExpression.prototype.hasOwnProperty(method)){verbalExpression[method]=VerbalExpression.prototype[method]}}return verbalExpression};VerbalExpression.prototype={_prefixes:"",_source:"",_suffixes:"",_modifiers:"gm",sanitize:function(value){if(value.source)return value.source;if(typeof value==="number")return value;return value.replace(/[^\w]/g,function(character){return"\\"+character})},add:function(value){this._source+=value||"";this.compile(this._prefixes+this._source+this._suffixes,this._modifiers);return this},startOfLine:function(enable){enable=enable!==false;this._prefixes=enable?"^":"";this.add("");return this},endOfLine:function(enable){enable=enable!==false;this._suffixes=enable?"$":"";this.add("");return this},then:function(value){value=this.sanitize(value);this.add("(?:"+value+")");return this},find:function(value){return this.then(value)},maybe:function(value){value=this.sanitize(value);this.add("(?:"+value+")?");return this},anything:function(){this.add("(?:.*)");return this},anythingBut:function(value){value=this.sanitize(value);this.add("(?:[^"+value+"]*)");return this},something:function(){this.add("(?:.+)");return this},somethingBut:function(value){value=this.sanitize(value);this.add("(?:[^"+value+"]+)");return this},replace:function(source,value){source=source.toString();return source.replace(this,value)},lineBreak:function(){this.add("(?:\\r\\n|\\r|\\n)");return this},br:function(){return this.lineBreak()},tab:function(){this.add("\\t");return this},word:function(){this.add("\\w+");return this},anyOf:function(value){value=this.sanitize(value);this.add("["+value+"]");return this},any:function(value){return this.anyOf(value)},range:function(){var value="[";for(var _to=1;_to<arguments.length;_to+=2){var from=this.sanitize(arguments[_to-1]);var to=this.sanitize(arguments[_to]);value+=from+"-"+to}value+="]";this.add(value);return this},addModifier:function(modifier){if(this._modifiers.indexOf(modifier)==-1){this._modifiers+=modifier}this.add("");return this},removeModifier:function(modifier){this._modifiers=this._modifiers.replace(modifier,"");this.add("");return this},withAnyCase:function(enable){if(enable!==false)this.addModifier("i");else this.removeModifier("i");this.add("");return this},stopAtFirst:function(enable){if(enable!==false)this.removeModifier("g");else this.addModifier("g");this.add("");return this},searchOneLine:function(enable){if(enable!==false)this.removeModifier("m");else this.addModifier("m");this.add("");return this},repeatPrevious:function(){var value;if(arguments.length<=1){if(/\d+/.exec(arguments[0])!==null){value="{"+arguments[0]+"}"}}else{var values=[];for(var i=0;i<arguments.length;i++){if(/\d+/.exec(arguments[i])!==null){values.push(arguments[i])}}value="{"+values.join(",")+"}"}this.add(value||"");return this},multiple:function(value){value=value.source?value.source:this.sanitize(value);if(arguments.length===1){this.add("(?:"+value+")*")}if(arguments.length>1){this.add("(?:"+value+")");this.add("{"+arguments[1]+"}")}return this},or:function(value){this._prefixes+="(?:";this._suffixes=")"+this._suffixes;this.add(")|(?:");if(value)this.then(value);return this},beginCapture:function(){this._suffixes+=")";this.add("(",false);return this},endCapture:function(){this._suffixes=this._suffixes.substring(0,this._suffixes.length-1);this.add(")",true);return this},toRegExp:function(){var arr=this.toString().match(/\/(.*)\/([a-z]+)?/);return new RegExp(arr[1],arr[2])}};function createVerbalExpression(){return new VerbalExpression}if(typeof module!=="undefined"&&module.exports){module.exports=createVerbalExpression}else if(typeof define==="function"&&define.amd){define(function(){return VerbalExpression})}else{root.VerEx=createVerbalExpression}}).call()},{}],2:[function(require,module,exports){(function(){"use strict";var _compose=function _compose(f,g){return function(){return f.call(this,g.apply(this,arguments))}};var _concat=function _concat(set1,set2){set1=set1||[];set2=set2||[];var idx;var len1=set1.length;var len2=set2.length;var result=[];idx=0;while(idx<len1){result[result.length]=set1[idx];idx+=1}idx=0;while(idx<len2){result[result.length]=set2[idx];idx+=1}return result};var _containsWith=function _containsWith(pred,x,list){var idx=0,len=list.length;while(idx<len){if(pred(x,list[idx])){return true}idx+=1}return false};var _curry1=function _curry1(fn){return function f1(a){if(arguments.length===0){return f1}else if(a!=null&&a["@@functional/placeholder"]===true){return f1}else{return fn(a)}}};var _curry2=function _curry2(fn){return function f2(a,b){var n=arguments.length;if(n===0){return f2}else if(n===1&&a!=null&&a["@@functional/placeholder"]===true){return f2}else if(n===1){return _curry1(function(b){return fn(a,b)})}else if(n===2&&a!=null&&a["@@functional/placeholder"]===true&&b!=null&&b["@@functional/placeholder"]===true){return f2}else if(n===2&&a!=null&&a["@@functional/placeholder"]===true){return _curry1(function(a){return fn(a,b)})}else if(n===2&&b!=null&&b["@@functional/placeholder"]===true){return _curry1(function(b){return fn(a,b)})}else{return fn(a,b)}}};var _isArray=Array.isArray||function _isArray(val){return val!=null&&val.length>=0&&Object.prototype.toString.call(val)==="[object Array]"};var _isTransformer=function _isTransformer(obj){return typeof obj["@@transducer/step"]==="function"};var _map=function _map(fn,list){var idx=0,len=list.length,result=[];while(idx<len){result[idx]=fn(list[idx]);idx+=1}return result};var _nth=function _nth(n,list){return n<0?list[list.length+n]:list[n]};var _slice=function _slice(args,from,to){switch(arguments.length){case 1:return _slice(args,0,args.length);case 2:return _slice(args,from,args.length);default:var list=[];var idx=0;var len=Math.max(0,Math.min(args.length,to)-from);while(idx<len){list[idx]=args[from+idx];idx+=1}return list}};var _xfBase={init:function(){return this.xf["@@transducer/init"]()},result:function(result){return this.xf["@@transducer/result"](result)}};var _xmap=function(){function XMap(f,xf){this.xf=xf;this.f=f}XMap.prototype["@@transducer/init"]=_xfBase.init;XMap.prototype["@@transducer/result"]=_xfBase.result;XMap.prototype["@@transducer/step"]=function(result,input){return this.xf["@@transducer/step"](result,this.f(input))};return _curry2(function _xmap(f,xf){return new XMap(f,xf)})}();var arity=_curry2(function(n,fn){switch(n){case 0:return function(){return fn.apply(this,arguments)};case 1:return function(a0){return fn.apply(this,arguments)};case 2:return function(a0,a1){return fn.apply(this,arguments)};case 3:return function(a0,a1,a2){return fn.apply(this,arguments)};case 4:return function(a0,a1,a2,a3){return fn.apply(this,arguments)};case 5:return function(a0,a1,a2,a3,a4){return fn.apply(this,arguments)};case 6:return function(a0,a1,a2,a3,a4,a5){return fn.apply(this,arguments)};case 7:return function(a0,a1,a2,a3,a4,a5,a6){return fn.apply(this,arguments)};case 8:return function(a0,a1,a2,a3,a4,a5,a6,a7){return fn.apply(this,arguments)};case 9:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8){return fn.apply(this,arguments)};case 10:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9){return fn.apply(this,arguments)};default:throw new Error("First argument to arity must be a non-negative integer no greater than ten")}});var lte=_curry2(function lte(a,b){return a<=b});var nth=_curry2(_nth);var uniqWith=_curry2(function uniqWith(pred,list){var idx=0,len=list.length;var result=[],item;while(idx<len){item=list[idx];if(!_containsWith(pred,item,result)){result[result.length]=item}idx+=1}return result});var _checkForMethod=function _checkForMethod(methodname,fn){return function(){var length=arguments.length;if(length===0){return fn()}var obj=arguments[length-1];return _isArray(obj)||typeof obj[methodname]!=="function"?fn.apply(this,arguments):obj[methodname].apply(obj,_slice(arguments,0,length-1))}};var _createComposer=function _createComposer(composeFunction){return function(){var fn=arguments[arguments.length-1];var length=fn.length;var idx=arguments.length-2;while(idx>=0){fn=composeFunction(arguments[idx],fn);idx-=1}return arity(length,fn)}};var _curryN=function _curryN(length,received,fn){return function(){var combined=[];var argsIdx=0;var left=length;var combinedIdx=0;while(combinedIdx<received.length||argsIdx<arguments.length){var result;if(combinedIdx<received.length&&(received[combinedIdx]==null||received[combinedIdx]["@@functional/placeholder"]!==true||argsIdx>=arguments.length)){result=received[combinedIdx]}else{result=arguments[argsIdx];argsIdx+=1}combined[combinedIdx]=result;if(result==null||result["@@functional/placeholder"]!==true){left-=1}combinedIdx+=1}return left<=0?fn.apply(this,combined):arity(left,_curryN(length,combined,fn))}};var _dispatchable=function _dispatchable(methodname,xf,fn){return function(){var length=arguments.length;if(length===0){return fn()}var obj=arguments[length-1];if(!_isArray(obj)){var args=_slice(arguments,0,length-1);if(typeof obj[methodname]==="function"){return obj[methodname].apply(obj,args)}if(_isTransformer(obj)){var transducer=xf.apply(null,args);return transducer(obj)}}return fn.apply(this,arguments)}};var _hasMethod=function _hasMethod(methodName,obj){return obj!=null&&!_isArray(obj)&&typeof obj[methodName]==="function"};var compose=_createComposer(_compose);var concat=_curry2(function(set1,set2){if(_isArray(set2)){return _concat(set1,set2)}else if(_hasMethod("concat",set1)){return set1.concat(set2)}else{throw new TypeError("can't concat "+typeof set1)}});var curryN=_curry2(function curryN(length,fn){return arity(length,_curryN(length,[],fn))});var head=nth(0);var invoker=_curry2(function invoker(arity,method){return curryN(arity+1,function(){var target=arguments[arity];return target[method].apply(target,_slice(arguments,0,arity))})});var last=nth(-1);var map=_curry2(_dispatchable("map",_xmap,_map));var split=invoker(1,"split");var tail=_checkForMethod("tail",function(list){return _slice(list,1)});var curry=_curry1(function curry(fn){return curryN(fn.length,fn)});var R={compose:compose,concat:concat,curry:curry,head:head,last:last,lte:lte,map:map,split:split,tail:tail,uniqWith:uniqWith};if(typeof exports==="object"){module.exports=R}else if(typeof define==="function"&&define.amd){define(function(){return R})}else{this.R=R}}).call(this)},{}],3:[function(require,module,exports){var VerEx=require("verbal-expressions"),R=require("../ramda.custom");var buildBase=function(data){if(!Array.isArray(data))throw new Error("Base should be an Array.");return data.map(function(item,idx){if(item===null||item===undefined)return;var typeofItem=typeof item;if(Array.isArray(item))return buildBase(item);if(typeofItem=="string")return normalize(item);if(typeofItem=="object")return normalizeObject(item)}).filter(onlyValids)};var normalizeObject=function(data){return Object.keys(data).reduce(function(object,key){var item=data[key];if(item===null||item===undefined)return object;var typeofItem=typeof item;var prop=null;if(typeofItem=="string")prop=normalize(item);if(Array.isArray(item))prop=buildBase(item);if(typeofItem=="object"&&!Array.isArray(item))prop=normalizeObject(item);if(onlyValids(prop))object[key]=prop;return object},{})};var buildEngine=function(base){return{search:search(base),base:base}};var search=R.curry(function(base,query){if(normalize(query).length==0)return base;query=query.toLowerCase();var term=VerEx().find(normalize(query));var markTerm=replace(normalize(query));var markAndHighlight=R.compose(highlight,markTerm);return searchWithinArray(base,term,markAndHighlight)});var searchWithinArray=function(base,term,markAndHighlight){return base.map(function(item){var typeofItem=typeof item;if(typeofItem=="string"&&test(term,item))return markAndHighlight(item);if(Array.isArray(item))return searchWithinArray(item,term,markAndHighlight);if(typeofItem=="object"&&!Array.isArray(item))return searchWithinObject(item,term,markAndHighlight)}).filter(onlyValids)};var searchWithinObject=function(base,term,markAndHighlight){return Object.keys(base).reduce(function(object,key){var item=base[key];var typeofItem=typeof item;var prop=null;if(typeofItem=="string"&&test(term,item))prop=markAndHighlight(item);if(Array.isArray(item))prop=searchWithinArray(item,term,markAndHighlight);if(typeofItem=="object"&&!Array.isArray(item))prop=searchWithinObject(item,term,markAndHighlight);if(onlyValids(prop))object[key]=prop;return object},{})};var replace=R.curry(function(to,phrase){return R.compose(mark(phrase),markRanges(phrase))(to).reduce(function(newPhrase,mark){return VerEx().find(mark.term).replace(newPhrase,mark.marked)},phrase)});var mark=R.curry(function(phrase,ranges){return ranges.map(function(range){var term=phrase.slice(R.head(range),R.last(range));return{marked:"<"+term+">",term:term}})});var markRanges=R.curry(function(phrase,to){var inits=[].reduce.call(phrase,function(ranges,letter,idx){return ranges.concat(phrase.toLowerCase().indexOf(to,idx))},[]).filter(R.lte(0));return R.compose(R.map(genRange(to.length)),R.uniqWith(NumberEq))(inits)});var genRange=R.curry(function(last,init){return[init,init+last]});var NumberEq=function(a,b){return Number(a)==Number(b)};var normalize=function(phrase){return phrase.trim()};var onlyValids=function(item){return item!==null&&(typeof item!="object"||Object.keys(item).length>0)};var test=function(term,value){value=value.toLowerCase();return term.test(value)||term.test(value)};var highlight=function(word){var head=R.split("<",word);var tail=R.tail(head).map(R.split(">")).reduce(R.concat,[]);return word.localeCompare(R.head(head))===0?[{chunk:R.head(head),highlight:false}]:R.concat([R.head(head)],tail).map(function(chunk,index){return{content:chunk,highlight:index%2!==0}}).filter(function(chunk){return chunk.content.length>0})};module.exports=function(data){return R.compose(buildEngine,buildBase)(data)}},{"../ramda.custom":2,"verbal-expressions":1}]},{},[3])(3)});